#!/usr/bin/za

llen = 100000
sz=9999

define then()
    return epoch_nano_time()
enddef

define now(then)
    print ": Took ",numcomma(time_diff(epoch_nano_time(),then),0)," us\n\n"
enddef

define listOp(list,var,expr)
    foreach {var} in list
        newlist=append(newlist,eval(expr))
    endfor
    return newlist
enddef

define reduce(list,var,expr)
    foreach {var} in list
        on eval(expr) do newlist=append(newlist,x)
    endfor
    return newlist
enddef

# build list

print "Building list.\n"
t=then()
for e=0 to llen-1
    list=append(list,rand(sz))
endfor
now(t)

t=then(); print "List Length : ",numcomma(len(list),0),"\n"; now(t)
println "First 100   : ",list[:100]
t=then(); print "[#4]Min         : [#-]",min(list),"\n"; now(t)
t=then(); print "[#4]Max         : [#-]",max(list),"\n"; now(t)
t=then(); print "[#4]Sum         : [#-]",sum(list),"\n"; now(t)
t=then(); print "[#4]Avg         : [#-]",avg(list),"\n"; now(t)

t=then()
 nl=listOp(list,"x","x/2")
println "[#4]Op (x/2)    : [#-]"
now(t)
println "list len nl -> ",len(nl)
println "First 100   : ",nl[:100]

reduce_expr="x>9899"
println "[#4]Reduce, all {reduce_expr} :[#-]"
t=then()
 newlist=uniq(list_int(reduce(list,"x",reduce_expr)))
now(t)
print "New list,unique numbers :\n"
print newlist,"\n"

print


