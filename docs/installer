#!/usr/bin/za

#  you'll probably need to do this manually until i have the
#  patience to write a generic script. feel free to contribute one!

zahandler=`
 Za shell scripts
  elseif s:name =~# '^za\>'
    set ft=za
`

if hasstart(os(),"freebsd")
    pathRoot="/usr/local/share/vim"
else
    pathRoot="/usr/share/vim"
endif

# where's vim at?

foreach p in dir(pathRoot)
    if hasstart(p.name,"vim8")
        allPaths=append(allPaths,p.name)
        break
    endif
endfor

if allPaths.len>0

    println "allpaths: ({allPaths})"
    vnum=(allPaths -> "#.substr(#.len-2,2)").list_float.max
    newPath=join([pathRoot,"vim"+vnum],"/")

    println "working path: [{newPath}]"

    # check for scripts.vim stanza
    infile=read_file(join([newPath,"scripts.vim"],"/"))
    if line_match(infile,"ft=za")
        println "stanza found"
    else
        infile=line_add(infile,zahandler)
        println "new scripts.vim:\n",infile,"\n"
    endif

    | sudo cp -f za.vim {newPath}/ftplugin/
    | sudo cp -f za.vim {newPath}/syntax/
    | sudo chmod 755 {newPath}/{syntax,ftplugin}/za.vim

endif


